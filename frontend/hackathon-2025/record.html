<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Demo - NovaVoice | Your 24/7 AI Voice Assistant</title>
  <link rel="stylesheet" href="styles.css" />
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
  <style>
    /* Fixed Header */
    .header-fixed {
      position: fixed;
      top: 0;
      width: 100%;
      z-index: 50;
      background: linear-gradient(to bottom, var(--bg), rgba(5, 8, 22, 0.9));
      backdrop-filter: blur(10px);
      border-bottom: 1px solid rgba(168, 85, 247, 0.1);
    }
    .header-nav {
      max-width: 1200px;
      margin: 0 auto;
      padding: 1rem 2rem;
      display: flex;
      align-items: center;
      justify-content: space-between;
    }
    .logo {
      display: flex;
      align-items: center;
      gap: 0.5rem;
      font-weight: 700;
      font-size: 1.25rem;
      color: white;
      text-decoration: none;
      transition: color 0.2s;
    }
    .logo:hover { color: var(--accent); }
    .logo-icon {
      width: 32px;
      height: 32px;
      background: linear-gradient(135deg, var(--brand), var(--brand-light));
      border-radius: 8px;
      display: flex;
      align-items: center;
      justify-content: center;
      color: white;
      font-size: 1.2rem;
    }
    .nav-links {
      display: flex;
      gap: 2rem;
      align-items: center;
    }
    .nav-link {
      color: white;
      text-decoration: none;
      font-weight: 500;
      transition: color 0.2s;
      font-size: 0.95rem;
    }
    .nav-link:hover { color: var(--brand); }

    .hero {
      padding: 120px 2rem 40px;
    }

    .card {
      margin-bottom: 16px;
    }

    @media (max-width: 768px) {
      .nav-links { display: none; }
    }
  </style>
</head>
<body>
  <!-- Fixed Header -->
  <header class="header-fixed">
    <nav class="header-nav">
      <a href="index.html" class="logo">
        <img src="logo.jpg" alt="NovaVoice" class="logo-img" style="width: 45px; height: 45px; object-fit: contain; filter: drop-shadow(0 0 10px rgba(168, 85, 247, 0.5)) brightness(1.2) contrast(1.1); mix-blend-mode: screen;">
        <span>NovaVoice</span>
      </a>
      <div class="nav-links">
        <a href="index.html" class="nav-link">Home</a>
        <a href="record.html" class="nav-link" style="color: var(--accent);">Try Demo</a>
        <a href="panel.html" class="nav-link">Configuration</a>
      </div>
    </nav>
  </header>

  <header class="container hero" style="padding-top: 140px; padding-bottom: 60px;">
    <h1>Experience <span class="highlight">NovaVoice</span> Live</h1>
    <p class="subtitle">Test our AI voice assistant in real-time. Press <strong>Start Call</strong> to begin, then <strong>hold Talk</strong> to speak with the AI. Your conversation is automatically transcribed.</p>
  </header>

  <main class="container">
    <!-- Call Controls Section -->
    <section class="card" style="margin-bottom: 24px;">
      <h2 style="font-size: 1.5rem; margin-bottom: 1.5rem; display: flex; align-items: center; gap: 0.75rem;">
        <span style="font-size: 2rem;">ğŸ™ï¸</span>
        Voice Controls
      </h2>

      <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(160px, 1fr)); gap: 12px; margin-bottom: 20px;">
        <button id="callBtn" class="btn" type="button" aria-pressed="false" style="padding: 1rem 1.5rem; font-size: 1.05rem;">
          ğŸ“ Start Call
        </button>

        <button id="talkBtn" class="btn" type="button" disabled title="Press and hold to talk" style="padding: 1rem 1.5rem; font-size: 1.05rem; background: var(--accent); color: #000;">
          ğŸ¤ Hold to Talk
        </button>
      </div>

      <div style="background: rgba(168, 85, 247, 0.08); padding: 16px; border-radius: 12px; border: 1px solid rgba(168, 85, 247, 0.2); margin-bottom: 20px;">
        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 12px;">
          <div style="display: flex; align-items: center; gap: 8px;">
            <span style="font-size: 1.2rem;">ğŸ“Š</span>
            <span id="callStatus" style="color: var(--fg); font-weight: 600;">Ready to start</span>
          </div>
          <div style="color: var(--accent); font-weight: 700; font-size: 1.3rem;" id="timer">00:00</div>
        </div>

        <div style="height: 16px; background: var(--card); border-radius: 9999px; overflow: hidden; border: 1px solid var(--border);">
          <div id="vu" style="height: 100%; width: 0%; background: linear-gradient(90deg, var(--brand), var(--brand-light)); transition: width 0.1s;"></div>
        </div>
      </div>

      <div style="display: flex; align-items: center; gap: 12px; padding: 14px; background: rgba(250, 204, 21, 0.08); border-left: 3px solid var(--accent); border-radius: 8px;">
        <span style="font-size: 1.5rem;">ğŸ’¡</span>
        <div>
          <strong style="color: var(--accent);">Pro Tip:</strong>
          <span style="color: var(--muted);"> Release "Talk" between sentences â€” silence isn't recorded.</span>
        </div>
      </div>

      <div style="margin-top: 16px; padding-top: 16px; border-top: 1px solid var(--border); display: flex; align-items: center; gap: 12px;">
        <label style="color: var(--muted); display: flex; align-items: center; gap: 8px; font-size: 0.95rem;">
          ğŸµ Audio Quality:
          <select id="bitrate" style="padding: 8px 12px; background: var(--card); border: 1px solid var(--border); border-radius: 8px; color: var(--fg); font-size: 0.95rem; cursor: pointer;">
            <option value="48k">48 kbps</option>
            <option value="64k" selected>64 kbps (Recommended)</option>
            <option value="96k">96 kbps</option>
          </select>
        </label>
      </div>
    </section>

    <!-- Activity Logs -->
    <section class="card" style="margin-bottom: 24px;">
      <h2 style="font-size: 1.5rem; margin-bottom: 1.2rem; display: flex; align-items: center; gap: 0.75rem;">
        <span style="font-size: 2rem;">ğŸ“</span>
        Activity Logs
      </h2>
      <div style="background: var(--card); padding: 16px; border-radius: 10px; border: 1px solid var(--border);">
        <pre id="log" style="white-space: pre-wrap; margin: 0; color: var(--muted); max-height: 200px; overflow: auto; font-size: 0.9rem; font-family: 'Courier New', monospace;">(No activity yet)</pre>
      </div>
    </section>

    <!-- Transcription Actions -->
    <section class="card" style="margin-bottom: 24px;">
      <div style="display: flex; align-items: center; justify-content: space-between; flex-wrap: wrap; gap: 12px;">
        <div style="display: flex; gap: 10px; align-items: center; flex-wrap: wrap;">
          <button id="transcribeLastBtn" class="btn btn-secondary" type="button" style="padding: 0.7rem 1.4rem;">
            ğŸ”„ Transcribe Last
          </button>
          <button id="retryPendingBtn" class="btn btn-secondary" type="button" style="padding: 0.7rem 1.4rem;">
            âš¡ Retry Pending
          </button>
        </div>
        <div style="display: flex; align-items: center; gap: 8px; padding: 10px 16px; background: rgba(168, 85, 247, 0.1); border-radius: 9999px;">
          <span style="color: var(--muted); font-size: 0.9rem;">Pending:</span>
          <span id="pendingCount" style="color: var(--accent); font-weight: 700; font-size: 1.1rem;">0</span>
        </div>
      </div>
    </section>

    <!-- Conversation Transcript -->
    <section class="card" style="margin-bottom: 24px;">
      <h2 style="font-size: 1.5rem; margin-bottom: 1.5rem; display: flex; align-items: center; gap: 0.75rem;">
        <span style="font-size: 2rem;">ğŸ’¬</span>
        Conversation Transcript
      </h2>

      <div class="transcript" style="display: grid; grid-template-columns: repeat(auto-fit, minmax(320px, 1fr)); gap: 20px; margin-bottom: 20px;">
        <!-- User Panel -->
        <div class="panel" id="userPanel" style="border: 2px solid var(--border); padding: 20px; border-radius: 14px; background: var(--glass-bg); backdrop-filter: blur(10px);">
          <div style="display: flex; align-items: center; justify-content: space-between; margin-bottom: 16px; padding-bottom: 12px; border-bottom: 1px solid var(--border);">
            <div style="display: flex; align-items: center; gap: 10px;">
              <span style="font-size: 1.5rem;">ğŸ‘¤</span>
              <strong style="font-size: 1.1rem;">You</strong>
            </div>
            <button class="btn btn-secondary" style="font-size: 0.85rem; padding: 6px 14px;" onclick="copyTranscript('userText')">
              ğŸ“‹ Copy
            </button>
          </div>
          <div id="userText" style="white-space: pre-wrap; color: var(--fg); min-height: 100px; line-height: 1.6; font-size: 0.95rem;">(Start speaking to see your transcript here)</div>
        </div>

        <!-- Agent Panel -->
        <div class="panel" id="agentPanel" style="border: 2px solid rgba(168, 85, 247, 0.4); padding: 20px; border-radius: 14px; background: linear-gradient(135deg, rgba(168, 85, 247, 0.08), rgba(192, 132, 252, 0.05)); backdrop-filter: blur(10px);">
          <div style="display: flex; align-items: center; justify-content: space-between; margin-bottom: 16px; padding-bottom: 12px; border-bottom: 1px solid rgba(168, 85, 247, 0.3);">
            <div style="display: flex; align-items: center; gap: 10px;">
              <span style="font-size: 1.5rem;">ğŸ¤–</span>
              <strong style="font-size: 1.1rem; color: var(--brand-light);">NovaVoice AI</strong>
            </div>
            <div style="display: flex; gap: 8px;">
              <button class="btn btn-secondary" style="font-size: 0.85rem; padding: 6px 14px;" onclick="copyTranscript('agentText')">
                ğŸ“‹ Copy
              </button>
              <button class="btn" style="font-size: 0.85rem; padding: 6px 14px; background: var(--accent); color: #000;" onclick="speakAgentResponse()">
                ğŸ”Š Listen
              </button>
            </div>
          </div>
          <div id="agentText" style="white-space: pre-wrap; color: var(--fg); min-height: 100px; line-height: 1.6; font-size: 0.95rem;">(AI response will appear here)</div>
        </div>
      </div>

      <!-- Transcript Actions -->
      <div style="display: flex; gap: 10px; flex-wrap: wrap; padding-top: 16px; border-top: 1px solid var(--border);">
        <button id="clearTranscriptBtn" class="btn btn-secondary" type="button" style="padding: 0.7rem 1.4rem;">
          ğŸ—‘ï¸ Clear Transcript
        </button>
        <button id="exportTranscriptBtn" class="btn" type="button" style="padding: 0.7rem 1.4rem;">
          ğŸ’¾ Export Transcript
        </button>
        <a href="index.html" class="btn btn-secondary" style="padding: 0.7rem 1.4rem; margin-left: auto;">
          â† Back to Home
        </a>
      </div>
    </section>
  </main>

  <footer class="footer">
    <div class="container footer-grid">
      <div>
        <div style="display: flex; align-items: center; gap: 0.75rem; margin-bottom: 0.75rem;">
          <img src="logo.jpg" alt="NovaVoice" style="width: 36px; height: 36px; object-fit: contain; filter: drop-shadow(0 0 8px rgba(168, 85, 247, 0.4)) brightness(1.2) contrast(1.1); mix-blend-mode: screen;">
          <h4 style="margin: 0;">NovaVoice</h4>
        </div>
        <p>Intelligent conversations. Instant help. Always available.</p>
      </div>
      <div>
        <h4>Product</h4>
        <ul>
          <li><a href="index.html">Home</a></li>
          <li><a href="record.html">Try Demo</a></li>
          <li><a href="panel.html">Configuration</a></li>
        </ul>
      </div>
      <div>
        <h4>Contact</h4>
        <ul>
          <li><a href="mailto:contact@novavoice.ai">contact@novavoice.ai</a></li>
          <li><a href="#">Support</a></li>
          <li><a href="#">LinkedIn</a></li>
        </ul>
      </div>
    </div>
    <div class="container footer-bottom">
      <small>Â© <span id="year"></span> NovaVoice. All rights reserved.</small>
    </div>
  </footer>

  <script>
    document.getElementById("year").textContent = new Date().getFullYear();

    // Helper functions for updating the transcript area from `record.js` or other scripts
    window.updateRecordedText = function(text){
      const el = document.getElementById('userText'); if(!el) return; el.textContent = text || '(No user text yet)';
      const log = document.getElementById('log'); if(log) log.textContent = (log.textContent||'') + '\n[User] ' + (text||'');
    };
    window.updateAgentResponse = function(text){
      const el = document.getElementById('agentText'); if(!el) return; el.textContent = text || '(No agent response yet)';
      const log = document.getElementById('log'); if(log) log.textContent = (log.textContent||'') + '\n[Agent] ' + (text||'');
    };
    window.copyTranscript = function(id){ const el = document.getElementById(id); if(!el) return alert('Nothing to copy'); navigator.clipboard.writeText(el.textContent||'').then(()=>alert('Copied')).catch(()=>alert('Copy failed')); };
    window.speakAgentResponse = function(){ const text = document.getElementById('agentText')?.textContent || ''; if (!text) return alert('No agent response to speak'); try{ const u = new SpeechSynthesisUtterance(text); speechSynthesis.cancel(); speechSynthesis.speak(u);}catch(e){ alert('TTS not available'); }};
    document.addEventListener('DOMContentLoaded', ()=>{
      document.getElementById('clearTranscriptBtn')?.addEventListener('click', ()=>{ document.getElementById('userText').textContent='(No user text yet)'; document.getElementById('agentText').textContent='(No agent response yet)'; });
      document.getElementById('exportTranscriptBtn')?.addEventListener('click', ()=>{
        const payload = { user: document.getElementById('userText')?.textContent||'', agent: document.getElementById('agentText')?.textContent||'', ts: new Date().toISOString() };
        const blob = new Blob([JSON.stringify(payload, null, 2)], {type:'application/json'});
        const url = URL.createObjectURL(blob); const a = document.createElement('a'); a.href = url; a.download = 'transcript_'+Date.now()+'.json'; document.body.appendChild(a); a.click(); a.remove(); URL.revokeObjectURL(url);
      });
    });
  </script>

  <!-- Simple MP3 encoder (libmp3lame via JavaScript) -->
  <script src="https://cdn.jsdelivr.net/npm/lamejs@1.2.1/lame.min.js"></script>
  <script src="record.js"></script>
</body>
</html>
